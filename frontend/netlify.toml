# This is the master configuration file for your Netlify deployment.
# This version uses an explicit production context to ensure it is not ignored.

# --- Base Build Settings (applies to all deploys) ---
[build]
  # This is the folder that Netlify will make public after a successful build.
  publish = "build"
  # This command is a fallback, but the production context will take precedence.
  command = "npm install && npm install --prefix backend && CI=false npm run build"

# --- Production Context ---
# These settings are applied specifically when deploying your main branch.
# This is a more robust way to configure builds and often solves detection issues.
[context.production]
  command = "npm install && npm install --prefix backend && CI=false npm run build"
  
  [context.production.environment]
    # This forces Netlify to use a stable version of Node.js for production builds.
    NODE_VERSION = "18"

# You can also add other contexts, like for deploy previews
# [context.deploy-preview]
#   command = "echo 'Building a preview...'"
